CREATE OR REPLACE PROCEDURE AUTH_DB2_ZOS_REPORT.USP_DATABASELIST_PARA( IN P_USERID VARCHAR(20) )
  SPECIFIC USP_DATABASELIST_PARA
  DYNAMIC RESULT SETS 1
  LANGUAGE SQL
  NOT DETERMINISTIC
  EXTERNAL ACTION
  MODIFIES SQL DATA
  CALLED ON NULL INPUT
  INHERIT SPECIAL REGISTERS
  OLD SAVEPOINT LEVEL
BEGIN 
  DECLARE cur CURSOR WITH RETURN FOR
 
--   SELECT SYSPLEX_CMDB_NAME AS DBNAME
--	FROM AUTH_DB2_ZOS_REPORT.VW_REPORT_DB2_ZOS_TABAUTH
--  GROUP BY SYSPLEX_CMDB_NAME
--  ;

--  SELECT DISTINCT S.SYSPLEX_CMDB_NAME AS DBNAME --,s.sachgebiet
--	FROM AUTH_DB2_ZOS_REPORT.VW_REPORT_DB2_ZOS_TABAUTH S
--	LEFT JOIN AUTH_DB2_ZOS_REPORT.VW_AUTH_DB2_ZOS_SACHGEBIET DBAS
--		ON DBAS.SACHGEBIET_CMDB_NAME = S.SACHGEBIET_CMDB_NAME
--	WHERE ( 1 = (SELECT 1 FROM AUTH_DB2_ZOS_REPORT.VW_DB2_ZOS_ADMINS WHERE USERID IN (P_USERID, 'LAN\' || P_USERID) FETCH FIRST 1 ROW ONLY) OR
--		DBAS.DBA_1 = P_USERID OR
--		DBAS.DBA_2 = P_USERID OR
--		DBAS.DBA_3 = P_USERID OR
--		DBAS.DATA_ENABLER_1 = P_USERID OR
--		DBAS.DATA_ENABLER_2 = P_USERID OR
--		DBAS.DATA_ENABLER_3 = P_USERID OR
--		DBAS.DATA_OWNER = P_USERID OR
--		DBAS.DATA_STEWARD_1 = P_USERID OR
--		DBAS.DATA_STEWARD_2 = P_USERID OR
--		DBAS.DATA_STEWARD_3 = P_USERID 
--	);

SELECT SYSPLEX_CMDB_NAME AS DBNAME FROM AUTH_DB2_ZOS_REPORT.VW_AUTH_DB2_ZOS_SYSPLEX ORDER BY SYSPLEX_CMDB_NAME;

	OPEN cur;		
END
